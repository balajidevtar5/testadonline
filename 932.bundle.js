"use strict";(self.webpackChunkclassified_app=self.webpackChunkclassified_app||[]).push([[932],{38932:(e,t,s)=>{s.r(t),s.d(t,{default:()=>F});var a=s(74848),i=s(96540),n=s(86990),l=s(12310),o=s(70032),c=s(50994),r=s(13216),d=s(90739),m=s(29586),u=s(61652);const g=e=>{const{UserListColumn:t,isLoading:s,updatedUserListData:m,totalItems:g,handleTableChange:p,rowSelection:h,selectedRowKeys:b,handleOk:f,isNotificationModelOpen:j,formState:y,register:x,control:v,setValue:S,handleSubmit:O,setIsNotificationModalOpen:N,onSubmit:w,setIsWhatsAppModalOpen:k,isWhatsappTemplateOpen:A,handleWhatsappTemplate:C,WhatsappTemplateList:T,handleChangeWhatsappTemplate:D,whatsappTemplateSubmit:P}=e,{isDarkMode:L}=(0,i.useContext)(u.M),[F,M]=(0,i.useState)(L?"#242424":"#fff"),[z,B]=(0,i.useState)(null),[I,R]=(0,i.useState)("");return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",Object.assign({className:"relative min-h-screen"},{children:[(0,a.jsxs)("div",Object.assign({className:"pb-20",style:{marginBottom:"100px"}},{children:[(0,a.jsxs)("div",Object.assign({className:"mt-60 d-flex flex-wrap gap justify-content-end p-10 pb-0 mb-60"},{children:[(0,a.jsx)("div",Object.assign({className:"pushnotificationbtn"},{children:(0,a.jsx)(n.A,Object.assign({disabled:0===b.length,className:0===b.length?"btn-disable":"",onClick:()=>N(!0)},{children:"Send SMS"}))})),(0,a.jsx)("div",Object.assign({className:"pushnotificationbtn"},{children:(0,a.jsx)(n.A,Object.assign({disabled:0===b.length,className:0===b.length?"btn-disable":"",onClick:()=>N(!0)},{children:"Push Notification"}))})),(0,a.jsx)("div",Object.assign({className:"pushnotificationbtn"},{children:(0,a.jsx)(n.A,Object.assign({disabled:0===b.length,className:0===b.length?"btn-disable":"",onClick:()=>N(!0)},{children:"Send Notification"}))})),(0,a.jsx)("div",Object.assign({className:"pushnotificationbtn"},{children:(0,a.jsx)(n.A,Object.assign({disabled:0===b.length,className:0===b.length?"btn-disable":"",onClick:()=>C()},{children:"Send Whatsapp Template"}))}))]})),(0,a.jsx)("div",Object.assign({className:"notificationModel"},{children:(0,a.jsx)(o.A,Object.assign({style:{backgroundColor:F},centered:!0,className:"notificationModel",title:"Send Notification",open:j,onOk:f,onCancel:()=>{N(!1),S("messageTitle",""),S("messageBody",""),S("url",""),B(null)}},{children:(0,a.jsxs)("form",Object.assign({id:"advertiseDetailsForm",onSubmit:O((e=>{return t=void 0,s=void 0,i=function*(){const t=new FormData;t.append("messageTitle",e.messageTitle),t.append("messageBody",e.messageBody),t.append("url",e.url),z&&t.append("image",z),yield w(t)},new((a=void 0)||(a=Promise))((function(e,n){function l(e){try{c(i.next(e))}catch(e){n(e)}}function o(e){try{c(i.throw(e))}catch(e){n(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof a?s:new a((function(e){e(s)}))).then(l,o)}c((i=i.apply(t,s||[])).next())}));var t,s,a,i})),style:{backgroundColor:F,color:L?"#fff":"#000"}},{children:[(0,a.jsx)("div",Object.assign({className:"p-10"},{children:(0,a.jsx)(d.Ay,Object.assign({className:"userDetailSendNotifTxt",style:{color:L?"#fff":"#000"}},{register:x,control:v,formState:y,id:"messageTitle",name:"messageTitle",autoFocus:!0,type:"text",className:"hideNumberSpin",placeholder:"Enter your message title",label:"Message Title*"}))})),(0,a.jsx)("div",Object.assign({className:"p-10"},{children:(0,a.jsx)(d.Ay,Object.assign({className:"userDetailSendNotifTxt",style:{color:L?"#fff":"#000"}},{register:x,control:v,formState:y,id:"messageBody",name:"messageBody",autoFocus:!0,type:"text",className:"hideNumberSpin",placeholder:"Enter your message body",label:"Message Body*"}))})),(0,a.jsx)("div",Object.assign({className:"p-10"},{children:(0,a.jsx)(d.Ay,Object.assign({className:"userDetailSendNotifTxt",style:{color:L?"#fff":"#000"}},{register:x,control:v,formState:y,id:"url",name:"url",autoFocus:!0,type:"text",className:"hideNumberSpin",placeholder:"Enter Redirection Url",label:"Redirection url*"}))})),(0,a.jsxs)("div",Object.assign({className:"p-10"},{children:[(0,a.jsx)("label",Object.assign({className:"form-label",style:{color:"darkorange"}},{children:"Upload Image*"})),(0,a.jsxs)("div",Object.assign({className:"custom-upload-wrapper"},{children:[(0,a.jsx)("label",Object.assign({className:"label"},{children:(0,a.jsx)("div",Object.assign({className:"drag-file-area"},{children:(0,a.jsxs)("span",Object.assign({className:"browse-files"},{children:[(0,a.jsx)("div",Object.assign({className:"upload-icon"},{children:(0,a.jsx)("img",{src:"/upload_image.png",alt:"Upload icon",style:{maxWidth:"25%",borderRadius:"7px",cursor:"pointer",marginTop:"20px"}})})),(0,a.jsx)("input",{type:"file",accept:"image/*",capture:"environment",name:"Document",id:"contained-button-file",title:"",onChange:e=>(e=>{if(e.target.files&&e.target.files.length>0){const t=e.target.files[0],s=10485760;if(t.size>s)return void alert("File size exceeds the maximum limit of 10MB.");if(!["image/jpeg","image/png","image/gif"].includes(t.type))return void alert("Only JPEG, PNG, and GIF images are allowed.");B(t)}})(e),multiple:!1,className:"default-file-input"}),(0,a.jsx)("span",Object.assign({className:"browse-files-text"},{children:"Browse file"})),(0,a.jsx)("span",{children:"from device"})]}))}))})),z&&(0,a.jsx)("div",Object.assign({className:"image-preview-card"},{children:(0,a.jsx)("div",Object.assign({className:"image-preview",style:{position:"relative"}},{children:(0,a.jsxs)("div",Object.assign({style:{position:"relative",display:"inline-block"}},{children:[(0,a.jsx)("img",{src:URL.createObjectURL(z),alt:"Preview",style:{maxHeight:"30vh",overflowY:"auto",maxWidth:"30vh"}}),(0,a.jsx)(l.A,{className:"delete-icon",onClick:()=>{B(null)},style:{position:"absolute",top:"5px",right:"5px",cursor:"pointer",color:"red",backgroundColor:"white",borderRadius:"50%",padding:"5px",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"}})]}))}))}))]}))]})),(0,a.jsxs)("div",Object.assign({className:"d-flex cursor-pointer gap p-10 align-items-center justify-content-end footer-dialog"},{children:[(0,a.jsx)(n.A,Object.assign({type:"reset",variant:"outlined",color:"error",className:"close-btn",onClick:()=>N(!1)},{children:"Close"})),(0,a.jsx)(n.A,Object.assign({type:"submit",form:"advertiseDetailsForm",variant:"contained",style:{minWidth:"88px"}},{children:"Send"}))]}))]}))}))})),(0,a.jsx)("div",Object.assign({style:{marginBottom:"100px"}},{children:(0,a.jsx)(c.A,{rowKey:"id",columns:t,dataSource:m||[],loading:s,pagination:{total:g,position:["bottomCenter"],showSizeChanger:!0,pageSizeOptions:["10","20","50","100"],defaultPageSize:10,className:"mb-16"},rowSelection:Object.assign({},h),onChange:p,className:"overflow-y-hidden mt-10"})}))]})),(0,a.jsx)("div",Object.assign({className:"fixed bottom-0 left-0 right-0 z-50"},{children:(0,a.jsx)(r.A,{})}))]}))})};var p=s(71468),h=s(84617),b=s(68785),f=s(69462),j=s(29318),y=s(42702),x=s(68777),v=s(63532),S=s(10871),O=s(49785),N=s(73289),w=s(74353),k=s.n(w),A=s(98867),C=s.n(A),T=s(8906),D=s.n(T),P=s(42983),L=function(e,t,s,a){return new(s||(s=Promise))((function(i,n){function l(e){try{c(a.next(e))}catch(e){n(e)}}function o(e){try{c(a.throw(e))}catch(e){n(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(l,o)}c((a=a.apply(e,t||[])).next())}))};k().extend(C()),k().extend(D());const F=()=>{const e=(0,p.wA)(),[t,s]=(0,i.useState)([]),n={Search:"",PageSize:10,PageNumber:1,SortColumn:"lastlogin",SortDirection:"desc"},[l,o]=(0,i.useState)(n),c=(0,i.useRef)(null),{data:r,isLoading:d}=(0,p.d4)((e=>e.userList)),{data:w}=(0,p.d4)((e=>e.loginUser)),[A,C]=(0,i.useState)(null),[T,D]=(0,i.useState)("checkbox"),[F,M]=(0,i.useState)([]),[z,B]=(0,i.useState)([]),[I,R]=(0,i.useState)(!1),[U,W]=(0,i.useState)(!1),[E,K]=(0,i.useState)(!1),[G,V]=(0,i.useState)([]),{register:_,formState:J,control:$,handleSubmit:H,setValue:Y,reset:q}=(0,O.mN)(),[Q,X]=(0,i.useState)([]),[Z,ee]=(0,i.useState)(!1),[te,se]=(0,i.useState)([]),[ae,ie]=(0,i.useState)(null),ne=(e,t,a)=>{t(),s((t=>{const s=[...t,{key:a,value:e[0]}],i={username:"UsernameSearch",location:"LocationSearch",mobileno:"PhoneSearch"},n=Object.assign({},l);if("lastlogin"===a){const[t,s]=e[0];n.FromDate=t,n.ToDate=s}return s.forEach((e=>{const t=i[e.key];t&&(n[t]=e.value)})),o(n),s}))},{isDarkMode:le}=(0,i.useContext)(u.M),oe=(e,i=!1)=>({filterDropdown:({setSelectedKeys:n,selectedKeys:r,confirm:d,clearFilters:u})=>(0,a.jsxs)("div",Object.assign({style:{padding:8,zIndex:1e3},onKeyDown:e=>e.stopPropagation(),className:"antclass"},{children:[i?(0,a.jsx)(f.A.RangePicker,{value:r[0]&&Array.isArray(r[0])&&2===r[0].length?[k()(r[0][0]),k()(r[0][1])]:[null,null],onChange:(e,t)=>{const[s,a]=t;n(s&&a?[[s,a]]:[])},className:"mobile-date-picker",style:{marginBottom:8,display:"block"},getPopupContainer:e=>e.parentElement,placement:"bottomLeft",popupStyle:{position:"fixed"}}):(0,a.jsx)(j.A,{ref:c,placeholder:`Search ${e}`,value:r[0],onChange:e=>n(e.target.value?[e.target.value]:[]),onPressEnter:()=>ne(r,d,e),style:{marginBottom:8,display:"block"}}),(0,a.jsxs)(y.A,{children:[(0,a.jsx)(x.Ay,Object.assign({type:"primary",disabled:i?!(r[0]&&2===r[0].length):!r[0],className:`btn-primary d-flex align-items-center ${m.A.searchFilter}`,onClick:()=>ne(r,d,e),icon:(0,a.jsx)(S.A,{sx:{color:"#63636370",width:"18px",height:"18px",mr:"3px"}}),size:"small",style:{width:90}},{children:"Search"})),(0,a.jsx)(x.Ay,Object.assign({onClick:()=>{u&&((e,a,i)=>{a({confirm:!0});const n=t.filter((e=>(null==e?void 0:e.key)!==i));s(n);const c={username:"UsernameSearch",location:"LocationSearch",mobileno:"PhoneSearch"}[i];if(c){const e=Object.assign({},l);delete e[c],o(e)}if("lastlogin"===i){const e=Object.assign({},l);delete e.FromDate,delete e.ToDate,o(e)}})(0,u,e),n([])},size:"small",style:{width:90}},{children:"Reset"}))]})]})),filterIcon:e=>(0,a.jsx)(S.A,{sx:{color:e?"#1890ff":le?"#fff":"#63636370",width:"18px",height:"18px",mr:"3px"}}),onFilter:(t,s)=>{var a,n;if(i&&Array.isArray(t)&&2===t.length){const[a,i]=t.map((e=>k()(e))),n=k()(s[e]);return n.isSameOrAfter(a.startOf("day"))&&n.isSameOrBefore(i.endOf("day"))}return null!==s[e]&&(null===(n=null===(a=s[e])||void 0===a?void 0:a.trim().toLowerCase())||void 0===n?void 0:n.includes(null==t?void 0:t.trim().toLowerCase()))},onFilterDropdownOpenChange:e=>{e&&setTimeout((()=>{var e;return null===(e=c.current)||void 0===e?void 0:e.select()}),100)},render:e=>e}),ce=[Object.assign({title:"User Name",dataIndex:"username",key:1,sorter:!0},oe("username")),Object.assign(Object.assign({title:"Location",dataIndex:"location",key:2},oe("location")),{sorter:!0}),Object.assign(Object.assign({title:"Phone Number",dataIndex:"mobileno",key:3},oe("mobileno")),{sorter:!0}),Object.assign(Object.assign({title:"Last Login At",dataIndex:"lastlogin",key:4,sorter:!0},oe("lastlogin",!0)),{render:e=>(0,b.Kr)(e)})],re={type:"checkbox",preserveSelectedRowKeys:!0,onChange:e=>{const t=Q.filter((t=>!e.includes(t)));se((s=>{const a=[...s.filter((t=>!e.includes(t))),...t];return Array.from(new Set(a))})),X(e)},selectedRowKeys:Q,onSelectAll:(e,t,s)=>{if(ee(!0),e){const e=r.data.map((e=>e.id));X(e),se([]),R(!0)}else X([]),se([]),R(!1)}};return(0,i.useEffect)((()=>{if(Z)if(I){const e=r.data.map((e=>e.id)).filter((e=>!te.includes(e)));e.length>0&&X((t=>{const s=new Set([...t,...e]);return Array.from(s)}))}else X([]),ee(!1)}),[I,r,te]),(0,i.useEffect)((()=>{var t;w&&(null==w?void 0:w.data)&&1===(null===(t=null==w?void 0:w.data[0])||void 0===t?void 0:t.roleid)&&e((0,h.eM)(l))}),[l,w]),(0,i.useEffect)((()=>{var e,t;if(r&&(null==r?void 0:r.data)){C(null===(e=null==r?void 0:r.data[0])||void 0===e?void 0:e.totalcount);const s=null===(t=null==r?void 0:r.data)||void 0===t?void 0:t.map(((e,t)=>Object.assign(Object.assign({},e),{key:e.id})));B(s)}}),[r]),(0,i.useEffect)((()=>()=>{o(n)}),[]),(0,a.jsx)("div",Object.assign({className:"relative min-h-screen"},{children:(0,a.jsx)(g,Object.assign({},{UserListColumn:ce,updatedUserListData:z,isLoading:d,totalItems:A,handleTableChange:(e,t,s,a)=>{o(Object.assign(Object.assign({},l),{PageSize:e.pageSize,PageNumber:e.current})),void 0===s.order?o(Object.assign(Object.assign({},l),{PageSize:e.pageSize,PageNumber:e.current,SortColumn:"lastlogin",SortDirection:"desc"})):Object.keys(s).length>0&&o(Object.assign(Object.assign({},l),{PageSize:e.pageSize,PageNumber:e.current,SortColumn:s.field,SortDirection:"descend"==s.order?"desc":"asc"}))},setSelectionType:D,selectionType:T,rowSelection:re,selectedRows:F,selectedRowKeys:Q,setSelectedRows:M,showNotificationModal:()=>{W(!0)},handleOk:()=>{W(!1),Y("messageTitle",""),Y("messageBody",""),Y("url","")},setValue:Y,isNotificationModelOpen:U,formState:J,register:_,handleSubmit:H,setIsNotificationModalOpen:W,setIsWhatsAppModalOpen:K,isWhatsappTemplateOpen:E,handleWhatsappTemplate:()=>L(void 0,void 0,void 0,(function*(){const e=yield(0,P.CW)();if(e.success){K(!0);const t=e.data.map((e=>Object.assign(Object.assign({},e),{label:e.name})));V(t)}})),WhatsappTemplateList:G,handleChangeWhatsappTemplate:e=>{ie(e)},control:$,onSubmit:e=>L(void 0,void 0,void 0,(function*(){try{const s=e.get("messageTitle"),a=e.get("messageBody"),i=e.get("url"),n=e.get("image");let l=null;n instanceof File&&(l={name:n.name,size:n.size,type:n.type,lastModified:n.lastModified});const o={userIds:I?te:Q,title:s,desc:a,url:i,isSelectAll:I},c={username:"UsernameSearch",location:"LocationSearch",mobileno:"PhoneSearch",lastlogin:["FromDate","ToDate"]};I&&t.forEach((e=>{"lastlogin"===e.key&&Array.isArray(e.value)?(o[c.lastlogin[0]]=e.value[0],o[c.lastlogin[1]]=e.value[1]):c[e.key]&&(o[c[e.key]]=e.value)}));const r=new FormData;r.append("model",JSON.stringify(o)),n instanceof File&&r.append("image",n);const d=yield(0,N.SB)(r);d.success&&(v.Ay.success(d.message),q({messageTitle:"",messageBody:"",url:"",image:""}),W(!1))}catch(e){}})),whatsappTemplateSubmit:()=>L(void 0,void 0,void 0,(function*(){const e={templateId:null==ae?void 0:ae.id,templateName:null==ae?void 0:ae.name,userIds:I?te:Q,isSelectAll:I},s={username:"UsernameSearch",location:"LocationSearch",mobileno:"PhoneSearch",lastlogin:["FromDate","ToDate"]};I&&t.forEach((t=>{"lastlogin"===t.key&&Array.isArray(t.value)?(e[s.lastlogin[0]]=t.value[0],e[s.lastlogin[1]]=t.value[1]):s[t.key]&&(e[s[t.key]]=t.value)}));const a=yield(0,P.Ss)(e);(null==a?void 0:a.success)&&(v.Ay.success(a.message),K(!1))}))}))}))}}}]);